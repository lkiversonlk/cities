<!DOCTYPE html>
<html lang="en"  >

<!-- BEGIN HEAD -->
<head>
	<meta charset="utf-8"/>
	<title>CitiesToken | Own a Geocode Token of the Big Cities</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<meta content="" name="description"/>
	<meta content="" name="author"/>
		<!-- BEGIN GLOBAL MANDATORY STYLES -->

	<link href="../assets/plugins/socicon/socicon.css" rel="stylesheet" type="text/css"/>
	<link href="../assets/plugins/bootstrap-social/bootstrap-social.css" rel="stylesheet" type="text/css"/>		
	<link href="../assets/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
	<link href="../assets/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css"/>
	<link href="../assets/plugins/animate/animate.min.css" rel="stylesheet" type="text/css"/>
	<link href="../assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
	<!-- END GLOBAL MANDATORY STYLES -->

			<!-- BEGIN: BASE PLUGINS  -->
			<link href="../assets/plugins/cubeportfolio/css/cubeportfolio.min.css" rel="stylesheet" type="text/css"/>
			<link href="../assets/plugins/owl-carousel/assets/owl.carousel.css" rel="stylesheet" type="text/css"/>
			<link href="../assets/plugins/fancybox/jquery.fancybox.css" rel="stylesheet" type="text/css"/>
			<link href="../assets/plugins/slider-for-bootstrap/css/slider.css" rel="stylesheet" type="text/css"/>
				<!-- END: BASE PLUGINS -->
	
	
    <!-- BEGIN THEME STYLES -->
	<link href="../assets/demos/default/css/plugins.css" rel="stylesheet" type="text/css"/>
	<link href="../assets/demos/default/css/components.css" id="style_components" rel="stylesheet" type="text/css"/>
	<link href="../assets/demos/default/css/themes/default.css" rel="stylesheet" id="style_theme" type="text/css"/>
	<link href="../assets/demos/default/css/custom.css" rel="stylesheet" type="text/css"/>
	<!-- END THEME STYLES -->

	<link rel="shortcut icon" href="favicon.ico"/>
</head><body class="c-layout-header-fixed c-layout-header-mobile-fixed">
	<script src="../assets/plugins/jquery.min.js" type="text/javascript" ></script>
	<script src="../assets/plugins/jquery-migrate.min.js" type="text/javascript" ></script>
	<script src="../assets/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript" ></script>
	<script src="../assets/plugins/jquery.easing.min.js" type="text/javascript" ></script>
  <script src="../assets/plugins/js-cookie/js.cookie.js" type="text/javascript"></script>
	<script src="../assets/base/js/ethereum.js" type="text/javascript"></script>
	<script src="../assets/base/js/renderDetail.js"></script>

	<div class="container">
		{{#each tokens}}
			<div e-id="{{{G2Id lat lon lv}}}" name="node">
				{{{G2Id lat lon lv}}}
			</div>
		{{/each}}

		<button id="gen">Generate</button>
	</div>

	<script>
		let ids = [];
		$('[name="node"]').each((i, ele) => {
			let id = ele.getAttribute('e-id')
			ether.stage(id)
			.then(stage => {
				if(stage == 'Unsold') {
					ids.push(id)
					$("#gen").text(`Generate ${ids.length}`)
				}
			})
		})

		$("#gen").click(() => {
			ether.getContractIns
			.then(ins => {
				let batchSize = 10
				for(let i = 0; (i + 1) *batchSize < ids.length; i ++){
					let _ids = ids.slice(i, i + batchSize)
					ins.produce_batch(
						_ids, 
						"20000000000000000", 
						"10000000000000000",
						(err, tx) => {
							if(err) {
								alert(err)
							} else {
								console.log(tx)
							}
						}
					)
				}
				
			})
		})
	</script>
</body>
</html>
